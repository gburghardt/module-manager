/*! module-manager 2014-05-16 */
;
/*! module-manager 2014-05-16 */
;this.Module=this.Module||{};(function(){function Factory(){}Factory.prototype={objectFactory:null,constructor:Factory,destructor:function(){this.objectFactory=null},getInstance:function(type){var instance=null,Klass=null;if(this.objectFactory){instance=this.objectFactory.getInstance(type)}if(!instance){if(/^[a-zA-Z][a-zA-Z0-9.]+[a-zA-Z0-9]$/.test(type)){try{Klass=eval(type)}catch(error){throw new Error("Class name "+type+" does not exist")}if(!Klass){throw new Error("Class name "+type+" does not exist")}else{if(typeof Klass!=="function"){throw new Error("Class name "+type+" is not a constructor function")}}instance=new Klass()}else{throw new Error("Cannot instantiate invalid type: "+type)}}return instance}};Module.Factory=Factory})();(function(){function a(){}a.prototype={baseClassName:"module",defaultModule:null,defaultModuleFocused:false,moduleObserver:{onModuleCreated:function(c,b,d){},onSubModuleCreated:function(c,b,d){},onModuleRegistered:function(b,c){},onModuleUnregistered:function(b){}},provider:null,registry:null,groups:null,constructor:Module.Manager,destructor:function(b){if(Module.manager===this){Module.manager=null}if(this.registry){this._destroyRegistry(b)}if(this.groups){this._destroyGroups()}if(this.provider){if(b){this.provider.destructor()}this.provider=null}if(this.lazyLoader){this.lazyLoader.destructor();this.lazyLoader=null}},_destroyGroups:function(){var c,e,b,d;for(c in this.groups){if(this.groups.hasOwnProperty(c)){e=this.groups[c];for(b=0,d=e.length;b<d;b++){e[b]=null}this.groups[c]=null}}this.groups=null},_destroyRegistry:function(d){var b,c;for(b in this.registry){if(this.registry.hasOwnProperty(b)){c=this.registry[b];this.moduleObserver.onModuleUnregistered(c.module);if(d){c.module.destructor(true)}c.module=null;this.registry[b]=null}}this.registry=null},init:function(){this.provider=this.provider||new Module.Provider();this.provider.factory=this.provider.factory||new Module.Factory();this.provider.manager=this;this.provider.moduleObserver=this.moduleObserver;this.registry=this.registry||{};this.groups=this.groups||{};Module.manager=this;return this},eagerLoadModules:function(d){var c=d.querySelectorAll("[data-modules]"),b=0;for(b;b<c.length;b++){this.createModules(c[b])}c=null;return this},lazyLoadModules:function(c,b){this.lazyLoader=(this.lazyLoader||new Module.LazyLoader()).setManager(this).setElement(c).setOptions(b).init();c=b=null;return this},createModule:function(d,f,b,e){var c=this.provider.createModule(d,f,b);if(e){this.registerModule(f,c)}d=b=null;return c},createModules:function(d,e){if(!d){throw new Error("Missing required argument: element")}else{if(!e&&d.getAttribute("data-module-lazyload")){return[]}else{if(d.getAttribute("data-module-property")){return[]}}}var b=new Module.MetaData(d),c=[];if(b.mediaMatches()){this.provider.createModules(b,function(h,g,i,f){c.push(h);this.registerModule(i,h);h.init()},this);this.markModulesCreated(d,b)}b=d=null;return c},focusDefaultModule:function(b){if(this.defaultModule&&!this.defaultModuleFocused){this.defaultModuleFocused=true;this.defaultModule.focus(b)}},initModuleInContainer:function(e,b,d,k,h,c){var g=new Date();var j={guid:c.guid,createdAt:g,timestamp:g.getTime(),controllerId:c.controllerId},i;if(d.renderData){for(i in d.renderData){if(d.renderData.hasOwnProperty(i)){j[i]=d.renderData[i]}}}var f=k.innerHTML.replace(/#\{([-.\w]+)\}/g,function(l,m){return j[m]||""});e.className+=(" "+this.baseClassName+" "+d.className).replace(/\s{2,}/g," ");e.innerHTML=f;if(d.insert==="top"&&b.firstChild){b.insertBefore(e,b.firstChild)}else{b.appendChild(e)}this.registerModule(h,c);c.init();if(d.autoFocus){c.focus(!!d.autoFocusAnything)}},markModulesCreated:function(c,b){c.setAttribute("data-modules-created",b.types.join(" "));c.removeAttribute("data-modules");c=b=null},registerModule:function(c,b){if(b.guid===undefined||b.guid===null){throw new Error("Cannot register module "+c+" without a guid property")}else{if(this.registry[b.guid]){throw new Error("Module "+b.guid+" has already been registered")}}this.registry[b.guid]={module:b,type:c};if(!this.groups[c]){this.groups[c]=[]}this.groups[c].push(b);this.moduleObserver.onModuleRegistered(b,c);b=null},unregisterModule:function(e){if(!e.guid||!this.registry[e.guid]){e=null;return false}var c=e.guid,f=this.registry[c].type,h=this.groups[f],b=false;this.registry[c].module=null;this.registry[c]=null;delete this.registry[c];if(h){for(var d=0,g=h.length;d<g;d++){if(h[d]===e){h.splice(d,1);b=true;this.moduleObserver.onModuleUnregistered(e);break}}}e=h=null;return b},setDefaultModule:function(b){if(!this.defaultModule){this.defaultModule=b}b=null}};Module.Manager=a})();(function(b){function a(c){this.options=null;this.types=[];if(c){this.setElement(c)}}a.prototype={element:null,media:null,options:null,types:null,constructor:a,forEach:function(j,f){var e=0,h=this.types.length,c,g,d;if(h===1){j.call(f,this.element,this.types[0],this.options,0,this)}else{for(e;e<h;++e){g=this.types[e];d=this.options[g]||{};c=j.call(f,this.element,g,d,e,this);if(c===false){break}}}},mediaMatches:function(){if(!b.matchMedia){throw new Error("This browser does not support JavaScript media queries. Please include a polyfill (https://github.com/paulirish/matchMedia.js)")}return this.media===null||b.matchMedia(this.media).matches},setElement:function(e){this.element=e;var d=e.getAttribute("data-modules"),c=e.getAttribute("data-module-options");if(!d){throw new Error("Missing required attribute data-modules on "+e.nodeName+"."+e.className.split(/\s+/g).join(".")+"#"+e.id)}this.types=d.replace(/^\s+|\s+$/g,"").split(/\s+/g);this.options=c?JSON.parse(c):{};this.media=e.getAttribute("data-module-media")}};b.Module.MetaData=a})(this);(function(){function a(){}a.prototype={factory:null,manager:null,moduleObserver:null,subModulesEnabled:true,constructor:a,destructor:function(b){if(b&&this.factory){this.factory.destructor()}this.factory=this.manager=null},_createModuleClass:function(b){return"module "+b.charAt(0).toLowerCase()+b.slice(1,b.length).replace(/(\.[A-Z])/g,function(d,c){return"-"+c.replace(/\./g,"").toLowerCase()}).replace(/Module$/,"").replace(/^\s+|\s+$/g,"")},createModule:function(d,f,b){var c=this.factory.getInstance(f);var e=this._createModuleClass(f);d.className+=d.className?" "+e:e;c.setElement(d);c.setOptions(b);if(b.defaultModule){this.manager.setDefaultModule(c)}this.moduleObserver.onModuleCreated(c,d,f);if(this.subModulesEnabled&&!b.subModulesDisabled){this._createSubModules(c)}return c},createModules:function(b,f,e){var c=[],d,f=f||function(){};b.forEach(function(h,i,g){d=this.createModule(h,i,g);c.push(d);f.call(e,d,h,i,g)},this);f=e=d=null;return c},_createSubModules:function(f){var e=f.element.getElementsByTagName("*"),g=e.length,d=0,c,b;for(d;d<g;d++){c=e[d];b=c.getAttribute("data-module-property");if(b){this._createSubModuleProperty(f,b,c)}}},_createSubModuleProperty:function(f,d,e){var b=new Module.MetaData(e),c;if(b.types.length>1){throw new Error("Sub module elements cannot have more than one type specified in data-modules")}c=this.createModule(e,b.types[0],b.options);this.moduleObserver.onSubModuleCreated(c,e,b.types[0]);c.init();if(f[d]===null){f[d]=c}else{if(f[d] instanceof Array){if(!f.hasOwnProperty(d)){f[d]=[]}f[d].push(c)}else{throw new Error("Cannot create sub module property '"+d+"'. Property is neither null nor an Array on the parent module.")}}this.manager.markModulesCreated(e,b);c=b=e=null}};Module.Provider=a})();
/*! module-manager 2014-05-16 */
;Module.FrontControllerModuleObserver=function FrontControllerModuleObserver(a){this.frontController=a||null};Module.FrontControllerModuleObserver.prototype={frontController:null,constructor:Module.FrontControllerModuleObserver,_ensureControllerId:function(a){a.controllerId=a.controllerId||a.options.controllerId||a.guid},onModuleCreated:function(b,a,c){this._ensureControllerId(b)},onSubModuleCreated:function(b,a,c){this.frontController.registerController(b)},onModuleRegistered:function(a,b){this.frontController.registerController(a)},onModuleUnregistered:function(a){this.frontController.unregisterController(a)}};
/*! module-manager 2014-05-16 */
;
/*! browser-viewport 2014-05-16 */
;function Viewport(a){if(!a){throw new Error("Missing required argument: window")}var m=this,d={"resize:complete":{type:"resize",handle:null,useCapture:false,bound:false,listeners:[],element:a},"scroll:complete":{type:"scroll",handle:null,useCapture:false,bound:false,listeners:[],element:a.document}},l=20,b=a.orientation||this.height>this.width?0:90;_orientationEvent={mql:a.matchMedia?a.matchMedia("(orientation: portrait)"):null,regex:/^orientation:\w+$/i,listeners:{count:0,"orientation:change":[],"orientation:portrait":[],"orientation:landscape":[]},test:function(n){return this.regex.test(n)&&!!this.listeners[n]}},_resizeTimer=null,_resizeTimeout=300,_scrollTimer=null,_scrollTimeout=300,createAccessor=function(o,n,p){Object.defineProperty(m,o,{enumerable:true,get:n,set:p})},createGetter=function(o,n){Object.defineProperty(m,o,{enumerable:true,get:n})};createGetter("bottom",function(){return a.pageYOffset+a.innerHeight});createGetter("document",function(){return a.document});createAccessor("eventListenerDelay",function(){return l},function(n){l=n});createGetter("height",function(){return a.innerHeight});createGetter("left",function(){return a.pageXOffset});createGetter("location",function(){return a.location});createGetter("orientation",function(){return b});createAccessor("resizeTimeout",function(){return _resizeTimeout},function(n){_resizeTimeout=n});createGetter("right",function(){return a.pageXOffset+a.innerWidth});createGetter("screen",function(){return a.screen});createAccessor("scrollTimeout",function(){return _scrollTimeout},function(n){_scrollTimeout=n});createGetter("top",function(){return a.pageYOffset});createGetter("width",function(){return a.innerWidth});createGetter("window",function(){return a});this.destructor=function(){if(_resizeTimer){a.clearTimeout(_resizeTimer);_resizeTimer=null}if(_scrollTimer){a.clearTimeout(_scrollTimer);_scrollTimer=null}f(d["resize:complete"]);f(d["scroll:complete"]);m=d=a=null};this.addEventListener=function(o,q){o=o.toLowerCase();var p,n;if(_orientationEvent.test(o)){n=_orientationEvent.listeners;if(!n.count&&_orientationEvent.mql){_orientationEvent.mql.addListener(j)}n[o].push(q);n.count++}else{if(p=d[o]){c(p);p.listeners.push(q)}}};this.removeEventListener=function(p,r){p=p.toLowerCase();var q,n,o;if(_orientationEvent.test(p)){o=_orientationEvent.listeners[p];n=o.indexOf(r);if(n>-1){o.splice(n,1);if(--o.count===0&&_orientationEvent.mql){_orientationEvent.mql.removeListener(j)}}}else{if(d[p]){q=d[p];n=q.listeners.indexOf(r);if(n>-1){q.listeners.splice(n,1);if(!q.listeners.length){f(q)}}}}};var c=function(n){if(n.bound){return}n.element.addEventListener(n.type,n.handle,n.useCapture);n.bound=true},g=function(){k(d["resize:complete"].listeners)},e=function(){k(d["scroll:complete"].listeners)},k=function(o){if(!o.length){return}var p=function(){if(++n===o.length||o[n](m)===false){return}a.setTimeout(p,l)},n=-1;p()},j=function(n){b=n.matches?0:a.orientation||90;k(_orientationEvent.listeners["orientation:change"]);if(n.matches){k(_orientationEvent.listeners["orientation:portrait"])}else{k(_orientationEvent.listeners["orientation:landscape"])}},h=function(n){if(_resizeTimer){a.clearTimeout(_resizeTimer);_resizeTimer=null}_resizeTimer=a.setTimeout(g,_resizeTimeout)},i=function(n){if(_scrollTimer){a.clearTimeout(_scrollTimer);_scrollTimer=null}_scrollTimer=a.setTimeout(e,_scrollTimeout)},f=function(n){if(!n.bound){return}n.element.removeEventListener(n.type,n.handle,n.useCapture);n.bound=false};d["resize:complete"].handle=h;d["scroll:complete"].handle=i}Viewport.prototype={constructor:Viewport,contains:function(a){var c=this.getElementPosition(a),b=this.getPosition();if(c.left<b.right&&c.right>b.left&&c.top<b.bottom&&c.bottom>b.top){return true}else{return false}},getElementPosition:function(a){var b={left:a.offsetLeft,top:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight};while(a=a.offsetParent){b.left+=a.offsetLeft;b.top+=a.offsetTop}b.right=b.left+b.width;b.bottom=b.top+b.height;return b},getPosition:function(){return{left:this.left,top:this.top,width:this.width,height:this.height,right:this.right,bottom:this.bottom}},is:function(a){return this===a||this.window===a||this.screen===a||this.document===a},matchMedia:function(a){return this.window.matchMedia?this.window.matchMedia(a):{matches:false}},querySelector:function(a,d,c){var b=null;this.querySelectorAll(a,function(e){b=e;return false});return b},querySelectorAll:function(b,h,e){h=h||function(){};e=e||this;var g=this.document.body.querySelectorAll(b),d=0,a,f=[],c;for(d;d<g.length;d++){c=g[d];if(this.contains(c)){f.push(c);if(a!==false){a=h.call(e,c,d,this)}}}return f},toString:function(){return"[object Viewport: "+this.location+"]"}};(function(){function a(){this.handleScrollComplete=this.handleScrollComplete.bind(this);this.handleResizeComplete=this.handleResizeComplete.bind(this);this.handleMouseover=this.handleMouseover.bind(this);this.options={resizeTimeout:0,scrollTimeout:0}}a.prototype={document:null,element:null,manager:null,options:null,viewport:null,window:null,constructor:a,destructor:function(){if(this.viewport){this.viewport.removeEventListener("scroll:complete",this.handleScrollComplete);this.viewport.removeEventListener("resize:complete",this.handleResizeComplete);this.viewport=null}if(this.element){this.element.removeEventListener("mouseover",this.handleMouseover,false);this.element=null}this.document=this.window=this.options=this.manager=null},init:function(){if(!this.viewport){this.setViewport(new Viewport(window))}if(this.options.resizeTimeout>0){this.viewport.resizeTimeout=this.options.resizeTimeout}if(this.options.scrollTimeout>0){this.viewport.scrollTimeout=this.options.scrollTimeout}this.viewport.addEventListener("scroll:complete",this.handleScrollComplete);this.viewport.addEventListener("resize:complete",this.handleResizeComplete);this.element.addEventListener("mouseover",this.handleMouseover,false);this._initModulesInViewport();return this},handleMouseover:function(b){b=b||window.event;b.target=b.target||b.srcElement;if(b.target.getAttribute("data-module-lazyload")){this._lazyLoadModules(b.target,b.type)}},handleScrollComplete:function(b){this._initModulesInViewport()},handleResizeComplete:function(b){this._initModulesInViewport()},_initModulesInViewport:function(){this.viewport.querySelectorAll("[data-module-lazyload]",function(b){this._lazyLoadModules(b,"scrollto")},this)},_lazyLoadModules:function(c,d){var b=c.getAttribute("data-module-lazyload");if(b==="any"||new RegExp(d).test(b)){if(this.manager.createModules(c,true).length){c.removeAttribute("data-module-lazyload");c.setAttribute("data-module-lazyloaded",b)}}},setElement:function(b){this.element=b;this.document=b.ownerDocument;this.window=this.document.defaultView;return this},setManager:function(b){this.manager=b;return this},setOptions:function(c){if(c){for(var b in c){if(c.hasOwnProperty(b)){this.options[b]=c[b]}}}return this},setViewport:function(b){this.viewport=b;this.setElement(b.document.documentElement);return this}};Module.LazyLoader=a})();